http:
  routers:
    oauth2-proxy-route:
      rule: "Host(`oauth2-proxy.his-test.local`)"
      service: oauth-backend
    keycloak:
      rule: "Host(`auth.his-test.local`)"
      entryPoints:
        - web
      service: keycloak
    app1:
      rule: "Host(`app1.his-test.local`)"
      entryPoints:
        - web
      service: app1-service
      middlewares:
        - forward-auth
    app2:
      rule: "Host(`app2.his-test.local`)"
      entryPoints:
        - web
      service: app2-service
      middlewares:
        - forward-auth
  services:
    oauth-backend:
      loadBalancer:
        servers:
          - url: http://oauth2-proxy:4180
    keycloak:
      loadBalancer:
        servers:
          - url: "http://keycloak:8080"
    app1-service:
      loadBalancer:
        servers:
          - url: "http://host.docker.internal:9797"
    app2-service:
      loadBalancer:
        servers:
          - url: "http://host.docker.internal:9798"
  middlewares:
    forward-auth:
      forwardAuth:
        address: "http://oauth2-proxy:4180"
        authResponseHeaders:
          - X-Auth-Request-Access-Token
          - Authorization
